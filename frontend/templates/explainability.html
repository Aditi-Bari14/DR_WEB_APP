<!DOCTYPE html>
<html>
<head>
    <title>Explainable AI</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<!-- NAVBAR -->
<div class="navbar">
    <div class="nav-left">
    </div>
    <div class="nav-right">
        <a href="/dashboard">Dashboard</a>
        <a href="/view-history">History</a>
        <a href="/login">Logout</a>
    </div>
</div>

<!-- EXPLAINABILITY CONTENT -->
<div class="container">

    <h2>Explainable AI (XAI)</h2>
    <p class="subtitle">
        Understanding how the model arrived at its prediction
    </p>

    <!-- PREDICTION SUMMARY -->
    <div class="xai-box">
        <h3>Prediction Summary</h3>
        <p><b>Patient ID:</b> {{ record.patient_id }}</p>
        <p><b>Prediction:</b> {{ record.prediction }}</p>
        <p><b>Confidence:</b> {{ record.confidence }}%</p>
        <p><b>Date:</b> {{ record.date }}</p>

    </div>

    <!-- VISUAL EXPLANATION -->
    <!-- VISUAL EXPLANATION -->
<div class="xai-box">
    <h3>Visual Explanation</h3>
    <p>
        The highlighted regions indicate areas of the retina
        that contributed most to the prediction.
    </p>

    <div class="xai-images">

        <!-- ORIGINAL IMAGE -->
        <div class="xai-image-box">
            <p class="img-title">Original Retina Image</p>
            <img
                src="http://127.0.0.1:8000/uploads/{{ record.image_name }}"
                class="xai-img"
                alt="Original Retina Image">
        </div>

        <!-- GRAD-CAM -->
        <div class="xai-image-box">
            <p class="img-title">Grad-CAM Heatmap</p>

            {% if gradcam_image %}
                <img src="{{ gradcam_image }}" class="img-fluid">
            {% else %}
                <div class="placeholder">Not Available</div>
            {% endif %}


        <!-- PROTOTYPE (EMPTY FOR NOW) -->
        <div class="xai-image-box">
            <p class="img-title">Prototype Similarity</p>
            <div class="image-placeholder">
                Not Implemented
            </div>
        </div>

    </div>
</div>


    <!-- TEXTUAL EXPLANATION -->
    <div class="xai-box">
        <h3>Model Interpretation</h3>
        <p>
            The model combines retinal image features extracted by the CNN,
            clinical attributes (Age, HbA1c, glucose statistics) modeled via GCN,
            and prototype similarity learning to provide an interpretable
            Diabetic Retinopathy stage prediction.
        </p>
    </div>

    <!-- BACK BUTTON -->
    <div style="margin-top: 20px;">
        <a href="/view-history" class="btn-primary">‚Üê Back to History</a>
    </div>

</div>

</body>
</html>
